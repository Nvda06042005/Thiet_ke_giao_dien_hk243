<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SWE â€“ StreetWearEazy</title>

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />

  <!-- Hero slider CSS -->
  <style>
    .hero{position:relative;overflow:hidden;min-height:80vh}
    .hero img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity 1s ease-in-out}
    .hero img.active{opacity:1}
    #admin-manage-btn { background-color: #dc3545; color: white; padding: 5px 10px; border-radius: 4px; text-decoration: none; margin-left: 15px; font-size: 14px; font-weight: 500; }
    /* áº¨n sá»‘ 0 trÃªn giá» hÃ ng ban Ä‘áº§u */
    .cart-count { display: none; }
  </style>
</head>
<body>
  <!-- === Báº®T BUá»˜C: THÃŠM FIREBASE SDK VÃ€O TRANG CHá»¦ === -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script>
      const firebaseConfig = { apiKey: "AIzaSyAAdIRdEEvsdyob6G-Fg6fhAeaCmVCJ_1s", authDomain: "swe-b1034.firebaseapp.com", projectId: "swe-b1034", storageBucket: "swe-b1034.appspot.com", messagingSenderId: "210346329221", appId: "1:210346329221:web:fb481a412c2d93605355ec", measurementId: "G-3LWDZWWEQR" };
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const db = firebase.firestore();
  </script>

  <!-- Top bar -->
  <div class="topbar">Miá»…n phÃ­ váº­n chuyá»ƒn vá»›i Ä‘Æ¡n hÃ ng trÃªn 500â€¯k. HÃ ng preâ€‘order cÃ²n Ä‘Æ°á»£c giáº£m thÃªm 5%.</div>

  <!-- Header -->
  <header>
    <div class="header-inner">
      <a href="index.html" class="logo">swe</a>
      <div class="search-box">
        <input type="text" placeholder="TÃ¬m kiáº¿m sáº£n pháº©m..." />
        <button aria-label="Search">ğŸ”</button>
      </div>
      <!-- === KHU Vá»°C USER Sáº¼ THAY Äá»”I Äá»˜NG === -->
      <div class="user-actions" id="user-area">
        <a href="tao_tk.html"><span class="icon">ğŸ‘¤</span> ÄÄƒng nháº­p / ÄÄƒng kÃ½</a>
        <a href="cart.html" class="cart" aria-label="Giá» hÃ ng"><span class="icon">ğŸ›’</span><span class="cart-count">0</span></a>
      </div>
    </div>
  </header>

  <!-- Navigation -->
  <nav class="main-nav">
    <ul>
      <li><a href="New Arrival.html">new arrivals</a></li>
      <li><a href="Best-selling item.html">bestâ€‘selling items</a></li>
      <li><a href="tops.html">tops</a></li>
      <li><a href="bottoms.html">bottoms</a></li>
      <li><a href="outerwear.html">outerwear</a></li>
      <li><a href="accessories.html">accessories</a></li>
      <li><a href="CLEARANCESALE.html">sale off</a></li>
      <li><a href="colections.html">táº¥t cáº£ sáº£n pháº©m</a></li>
    </ul>
  </nav>

  <!-- Hero slider -->
  <section class="hero">
    <img src="trang chá»§/banner.jpg" class="slide active" alt="Banner 1" />
    <img src="trang chá»§/banner2.jpg" class="slide" alt="Banner 2" />
  </section>

  <!-- Services -->
  <section class="services">
    <div class="service"><span class="s-icon">ğŸšš</span>Giao hÃ ng miá»…n phÃ­<small>vá»›i Ä‘Æ¡n hÃ ng tá»« 500â€¯k trá»Ÿ lÃªn</small></div>
    <div class="service"><span class="s-icon">ğŸ’¬</span>Há»— trá»£ 24/7<small>Há»— trá»£ online / offline 24/7</small></div>
    <div class="service"><span class="s-icon">ğŸ”„</span>Miá»…n phÃ­ Ä‘á»•i tráº£<small>Trong vÃ²ng 7 ngÃ y</small></div>
    <div class="service"><span class="s-icon">ğŸ“</span>Äáº·t hÃ ng trá»±c tuyáº¿n<small>Hotline: 0357Â 420Â 420</small></div>
  </section>

  <!-- === KHU Vá»°C Sáº¢N PHáº¨M Má»šI Tá»ª DATABASE === -->
  <section id="dynamic-products" class="product-row">
    <h2 class="section-title">Sáº¢N PHáº¨M Má»šI NHáº¤T</h2>
    <div class="product-grid" id="product-display-area">
      <p>Äang táº£i sáº£n pháº©m...</p>
    </div>
  </section>

   <!-- THE FUTURE IS BRIGHT (GIá»® NGUYÃŠN) -->
  <section id="new" class="product-row">
    <h2 class="section-title">THE FUTURE IS BRIGHT</h2>
    <div class="product-grid">
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/in1.jpg" alt="SWE HOODSTACK ZIP JACKET â€“ BLACK"><div class="product-info"><h3>SWE HOODSTACK ZIP JACKET â€“ BLACK</h3><p class="price"><del>825,000â‚«</del> <strong>750,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/in2.jpg" alt="SWE HOODSTACK ZIP JACKET â€“ BROWN"><div class="product-info"><h3>SWE HOODSTACK ZIP JACKET â€“ BROWN</h3><p class="price"><del>825,000â‚«</del> <strong>750,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/in3.jpg" alt="SWE VISION L/S TEE â€“ CREAM"><div class="product-info"><h3>SWE VISION L/S TEE â€“ CREAM</h3><p class="price"><del>520,000â‚«</del> <strong>480,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/in4.jpg" alt="SWE VISION L/S TEE â€“ BROWN"><div class="product-info"><h3>SWE VISION L/S TEE â€“ BROWN</h3><p class="price"><del>520,000â‚«</del> <strong>480,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
    </div>
  </section>

  <!-- BESTâ€‘SELLING ITEMS (GIá»® NGUYÃŠN) -->
  <section id="best" class="product-row">
    <h2 class="section-title">BESTâ€‘SELLING ITEMS</h2>
    <div class="product-grid">
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best1.jpg" alt="SWE SCRIPT JACKET â€“ BLACK"><div class="product-info"><h3>SWE SCRIPT JACKET â€“ BLACK</h3><p class="price"><del>792,000â‚«</del> <strong>720,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best2.jpg" alt="SWE SCRIPT JACKET â€“ BEIGE"><div class="product-info"><h3>SWE SCRIPT JACKET â€“ BEIGE</h3><p class="price"><del>792,000â‚«</del> <strong>720,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best3.jpg" alt="SWE CREST BOXY TEE â€“ WHITE"><div class="product-info"><h3>SWE CREST BOXY TEE â€“ WHITE</h3><p class="price"><del>440,000â‚«</del> <strong>400,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best4.jpg" alt="SWE SKEYE BOXY TEE â€“ WHITE"><div class="product-info"><h3>SWE SKEYE BOXY TEE â€“ WHITE</h3><p class="price"><del>462,000â‚«</del> <strong>420,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best5.jpg" alt="SWE KID TEE â€“ WHITE"><div class="product-info"><h3>SWE PEEKING POCKET BOXY TEE â€“ WHITE</h3><p class="price"><del>385,000â‚«</del> <strong>350,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘22%</span><img src="trang chá»§/best6.jpg" alt="SWE 2BAR BABY TEE â€“ RED"><div class="product-info"><h3>SWE RED BUTTON SHIRT â€“ BLACK</h3><p class="price"><del>495,000â‚«</del> <strong>386,100â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best7.jpg" alt="SWE LIFE TEE â€“ BLACK"><div class="product-info"><h3>SWE PIN BUTTON SHIRT â€“ GRAYK</h3><p class="price"><del>495,000â‚«</del> <strong>450,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best8.jpg" alt="SWE HAZE BABY TEE â€“ BLUE"><div class="product-info"><h3>SWE ARC WIDE JEANS â€“ MUD FADE</h3><p class="price"><del>792,000â‚«</del> <strong>720,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best9.jpg" alt="SWE VISION L/S TEE â€“ BROWN"><div class="product-info"><h3>SWE DUNE DESTROYED JEANS â€“  BLUE</h3><p class="price"><del>759,000â‚«</del> <strong>690,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘16%</span><img src="trang chá»§/best10.jpg" alt="SWE OMBRE HOODIE â€“ GREY"><div class="product-info"><h3>SWE NOMAD DENIM SHORTS â€“ WASHED BLUE</h3><p class="price"><del>660,000â‚«</del> <strong>554,400â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best11.jpg" alt="SWE CAMO CARGO PANTS"><div class="product-info"><h3>SWE SIGNATURE TEE â€“ BLACK</h3><p class="price"><del>410,000â‚«</del> <strong>380,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘26%</span><img src="trang chá»§/best12.jpg" alt="SWE VISION L/S TEE â€“ CREAM"><div class="product-info"><h3>SWE NINER TEE â€“ BLACK</h3><p class="price"><del>429,000â‚«</del> <strong>317,460â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘18%</span><img src="trang chá»§/best13.jpg" alt="SWE OVERSIZED DENIM JACKET"><div class="product-info"><h3>SWE LIFE TEE â€“ BLACK</h3><p class="price"><del>418,000â‚«</del> <strong>342,760â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘21%</span><img src="trang chá»§/best14.jpg" alt="SWE STACKED JEANS â€“ BLACK"><div class="product-info"><h3>SWE KID TEE â€“ WHITE</h3><p class="price"><del>462,000â‚«</del> <strong>364,980â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">háº¿t hÃ ng</span><img src="trang chá»§/best15.jpg" alt="SWE TURTLENECK KNIT â€“ CREAM"><div class="product-info"><h3>SWE 2BAR BABY TEE â€“ RED</h3><p class="price"><del>286,000â‚«</del> <strong>260,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
      <div class="product-card"><span class="discount">â€‘9%</span><img src="trang chá»§/best17.jpg" alt="SWE PUFFER JACKET â€“ OLIVE"><div class="product-info"><h3>SWE HAZE WASHED BABY TEE  â€“ BLUE</h3><p class="price"><del>308,000â‚«</del> <strong>280,000â‚«</strong></p><ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul><button class="buy-btn">ThÃªm vÃ o giá»</button></div></div>
    </div>
  </section>

  <!-- Feedback -->
  <section class="feedback">
    <h2 class="section-title">FEEDBACK</h2>
    <div class="gallery">
      <img src="trang chá»§/feedback1.jpg" class="img-a" alt="Feedback 1"><img src="trang chá»§/feedback2.jpg" class="img-b" alt="Feedback 2"><img src="trang chá»§/feedback3.jpg" class="img-c" alt="Feedback 3"><img src="trang chá»§/feedback4.jpg" class="img-d" alt="Feedback 4"><img src="trang chá»§/feedback5.jpg" class="img-e" alt="Feedback 5">
    </div>
  </section>

  <!-- Subscribe -->
  <section class="subscribe">
    <form class="subscribe-form"><span class="sub-label"><img src="trang chá»§/email.png" alt=""> Nháº­n khuyáº¿n mÃ£i</span><div class="input-wrap"><input type="email" placeholder="Nháº­p email cá»§a báº¡n" required><button type="submit"><img src="trang chá»§/email.png" alt="Gá»­i"></button></div></form>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="footer-top">
      <div><h4>About Us</h4><p>DÆ°á»£c thÃ nh láº­p vÃ o cuá»‘i nÄƒm 2016...</p></div>
      <div><h4>ChÃ­nh sÃ¡ch</h4><ul><li>ChÃ­nh sÃ¡ch báº£o máº­t</li><li>HÆ°á»›ng dáº«n mua hÃ ng</li><li>PhÆ°Æ¡ng thá»©c thanh toÃ¡n</li><li>ChÃ­nh sÃ¡ch giao nháº­n â€“ váº­n chuyá»ƒn</li><li>ChÃ­nh sÃ¡ch Ä‘á»•i vÃ  báº£o hÃ nh sáº£n pháº©m</li></ul></div>
      <div><h4>Há»‡ thá»‘ng cá»­a hÃ ng SWE</h4><ul><li>Store 1: 44A Tráº§n Quang Diá»‡u...</li><li>Store 2: TNP, 26 LÃ½ Tá»± Trá»ng...</li><li>Store 3: Store 29-30 TNP...</li><li>Äáº¡i lÃ½ phÃ¢n phá»‘i chÃ­nh hÃ£ng...</li><li>â˜ï¸ 0357 420 420</li><li>âœ‰ï¸ streetweareazy@gmail.com</li></ul></div>
    </div>
    <div class="footer-bottom">Copyright Â© 2025 SWE (STREETWEAREAZY). Powered by Haravan</div>
  </footer>

  <!-- Floating contacts -->
  <div class="float-contacts"><a href="tel:0357420420" class="call"><img src="trang chá»§/Ä‘iá»‡n thoáº¡i.png" alt="call" /></a><a href="https://zalo.me/" class="zalo"><img src="trang chá»§/zalo.jpg" alt="zalo" /></a><a href="mailto:streetweareazy@gmail.com" class="mail"><img src="trang chá»§/email.png" alt="mail" /></a><a href="https://m.me/StreetWearEazy" class="mess"><img src="trang chá»§/message.png" alt="messenger" /></a></div>

  <!-- Slider JS -->
  <script>
    const slides=document.querySelectorAll('.hero .slide');
    let idx=0;
    setInterval(()=>{
      slides[idx].classList.remove('active');
      idx=(idx+1)%slides.length;
      slides[idx].classList.add('active');
    },5000);
  </script>

  <!-- === JAVASCRIPT Cá»¦A TRANG CHá»¦ (ÄÃƒ NÃ‚NG Cáº¤P Vá»šI GIá» HÃ€NG) === -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        const productArea = document.getElementById('product-display-area');
        const userArea = document.getElementById('user-area');

        // 1. THEO DÃ•I TRáº NG THÃI ÄÄ‚NG NHáº¬P VÃ€ Cáº¬P NHáº¬T HEADER
        auth.onAuthStateChanged(user => {
            const cartCountElement = document.querySelector('.cart-count');
            if (user) {
                db.collection('users').doc(user.uid).get().then(doc => {
                    if (doc.exists) {
                        const userData = doc.data();
                        let html = `<div style="display: flex; align-items: center; gap: 15px;"><span style="font-weight: 500;">Xin chÃ o, ${userData.ten}</span><a href="#" id="logout-btn" style="text-decoration: underline;">ÄÄƒng xuáº¥t</a>`;
                        if (userData.role === 'admin') {
                            html += `<a href="tao_tk.html" id="admin-manage-btn">Quáº£n lÃ½</a>`;
                        }
                        html += `</div><a href="cart.html" class="cart" aria-label="Giá» hÃ ng"><span class="icon">ğŸ›’</span><span class="cart-count">0</span></a>`;
                        userArea.innerHTML = html;
                        document.getElementById('logout-btn').addEventListener('click', e => { e.preventDefault(); auth.signOut(); });
                        listenToCart(user.uid);
                    }
                });
            } else {
                userArea.innerHTML = `<a href="tao_tk.html"><span class="icon">ğŸ‘¤</span> ÄÄƒng nháº­p / ÄÄƒng kÃ½</a><a href="cart.html" class="cart" aria-label="Giá» hÃ ng"><span class="icon">ğŸ›’</span><span class="cart-count">0</span></a>`;
                if (cartCountElement) cartCountElement.style.display = 'none';
            }
        });

        // 2. Táº¢I VÃ€ HIá»‚N THá»Š Sáº¢N PHáº¨M Tá»ª FIRESTORE
        db.collection('products').orderBy('createdAt', 'desc').onSnapshot(snapshot => {
            let productHTML = '';
            if (snapshot.empty) {
                productArea.innerHTML = "<p>ChÆ°a cÃ³ sáº£n pháº©m nÃ o Ä‘Æ°á»£c Ä‘Äƒng bÃ¡n.</p>";
                return;
            }
            snapshot.forEach(doc => {
                const product = doc.data();
                productHTML += `
                    <div class="product-card" data-id="${doc.id}">
                        <img src="${product.imageUrl}" alt="${product.name}">
                        <div class="product-info">
                            <h3>${product.name}</h3>
                            <p class="price"><strong>${product.price.toLocaleString('vi-VN')}â‚«</strong></p>
                            <ul class="rating" data-reviews="0"><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><li>â˜†</li><span class="review-count">(0 Ä‘Ã¡nh giÃ¡)</span></ul>
                            <button class="buy-btn">ThÃªm vÃ o giá»</button>
                        </div>
                    </div>
                `;
            });
            productArea.innerHTML = productHTML;
            attachAddToCartListeners();
        });

        // 3. HÃ€M Gáº®N Sá»° KIá»†N "THÃŠM VÃ€O GIá»" CHO Táº¤T Cáº¢ CÃC NÃšT
        function attachAddToCartListeners() {
            // Gáº¯n sá»± kiá»‡n cho cáº£ sáº£n pháº©m Ä‘á»™ng vÃ  sáº£n pháº©m tÄ©nh
            const allBuyButtons = document.querySelectorAll('.buy-btn');
            allBuyButtons.forEach(button => {
                button.addEventListener('click', function(event) {
                    if (!auth.currentUser) {
                        alert('Vui lÃ²ng Ä‘Äƒng nháº­p Ä‘á»ƒ thÃªm sáº£n pháº©m vÃ o giá» hÃ ng!');
                        return;
                    }
                    const card = event.target.closest('.product-card');
                    const productId = card.dataset.id; // Láº¥y ID tá»« sáº£n pháº©m Ä‘á»™ng
                    
                    // Náº¿u lÃ  sáº£n pháº©m tÄ©nh, chÃºng ta cáº§n láº¥y thÃ´ng tin tá»« HTML
                    if (!productId) {
                        const name = card.querySelector('h3').textContent;
                        const priceText = card.querySelector('.price strong').textContent;
                        const price = parseFloat(priceText.replace(/[^0-9]/g, ''));
                        const imageUrl = card.querySelector('img').src;
                        // Táº¡o má»™t ID giáº£ dá»±a trÃªn tÃªn Ä‘á»ƒ lÆ°u vÃ o giá» hÃ ng
                        const staticProductId = name.replace(/\s+/g, '-').toLowerCase();
                        
                        addToCart(staticProductId, { name, price, imageUrl });
                    } else {
                        addToCart(productId);
                    }
                });
            });
        }

        // 4. HÃ€M Xá»¬ LÃ LOGIC THÃŠM Sáº¢N PHáº¨M VÃ€O FIRESTORE
        function addToCart(productId, productData = null) {
            const userId = auth.currentUser.uid;
            const cartItemRef = db.collection('carts').doc(userId).collection('items').doc(productId);

            db.runTransaction(transaction => {
                return transaction.get(cartItemRef).then(doc => {
                    if (!doc.exists) {
                        if (productData) { // Náº¿u lÃ  sáº£n pháº©m tÄ©nh, dÃ¹ng data Ä‘Ã£ láº¥y
                            transaction.set(cartItemRef, { ...productData, quantity: 1 });
                        } else { // Náº¿u lÃ  sáº£n pháº©m Ä‘á»™ng, láº¥y data tá»« collection 'products'
                            const productRef = db.collection('products').doc(productId);
                            return transaction.get(productRef).then(productDoc => {
                                if (productDoc.exists) {
                                    transaction.set(cartItemRef, { ...productDoc.data(), quantity: 1 });
                                }
                            });
                        }
                    } else {
                        const newQuantity = doc.data().quantity + 1;
                        transaction.update(cartItemRef, { quantity: newQuantity });
                    }
                });
            }).then(() => {
                alert('ÄÃ£ thÃªm sáº£n pháº©m vÃ o giá» hÃ ng!');
            }).catch(error => {
                console.error("Lá»—i khi thÃªm vÃ o giá» hÃ ng: ", error);
            });
        }

        // 5. HÃ€M Láº®NG NGHE VÃ€ Cáº¬P NHáº¬T Sá» LÆ¯á»¢NG TRÃŠN ICON GIá» HÃ€NG
        function listenToCart(userId) {
            const cartCountElement = document.querySelector('.cart-count');
            db.collection('carts').doc(userId).collection('items').onSnapshot(snapshot => {
                let totalItems = 0;
                snapshot.forEach(doc => {
                    totalItems += doc.data().quantity;
                });
                if (cartCountElement) {
                    cartCountElement.textContent = totalItems;
                    cartCountElement.style.display = totalItems > 0 ? 'flex' : 'none';
                }
            });
        }
        
        // Gá»i hÃ m nÃ y ngay khi trang táº£i xong Ä‘á»ƒ gáº¯n sá»± kiá»‡n cho cÃ¡c sáº£n pháº©m tÄ©nh
        attachAddToCartListeners();
    });
  </script>
</body>
</html>